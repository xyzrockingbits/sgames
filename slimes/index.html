<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ë–∏—Ç–≤–∞ –°–ª–∞–π–º–æ–≤</title>
    <style>
        :root {
            --bg-color: #2c3e50;
            --board-bg: #34495e;
            --p1-color: #ff4757; /* –ö—Ä–∞—Å–Ω—ã–π */
            --p2-color: #2ed573; /* –ó–µ–ª–µ–Ω—ã–π/–°–∏–Ω–∏–π */
            --text-color: #ecf0f1;
            --hint-clone: rgba(46, 213, 115, 0.5);
            --hint-jump: rgba(255, 165, 2, 0.5);
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: var(--bg-color);
            color: var(--text-color);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 100vh;
            margin: 0;
            user-select: none;
        }

        h1, h2 { margin: 10px 0; }

        /* –≠–∫—Ä–∞–Ω—ã */
        .screen {
            display: none;
            flex-direction: column;
            align-items: center;
            text-align: center;
            max-width: 600px;
            padding: 20px;
        }

        .active { display: flex; }

        /* –ü—Ä–∞–≤–∏–ª–∞ */
        .rules-box {
            background: rgba(0,0,0,0.2);
            padding: 20px;
            border-radius: 15px;
            margin-bottom: 20px;
            text-align: left;
            line-height: 1.6;
        }
        .rules-box li { margin-bottom: 10px; }

        /* –ö–Ω–æ–ø–∫–∏ */
        button {
            background: var(--p2-color);
            color: white;
            border: none;
            padding: 15px 30px;
            font-size: 1.2rem;
            border-radius: 50px;
            cursor: pointer;
            transition: transform 0.1s;
            font-weight: bold;
            box-shadow: 0 4px 0 #219d53;
        }
        button:active { transform: translateY(4px); box-shadow: none; }
        button.restart { background: #eccc68; box-shadow: 0 4px 0 #c4a954; font-size: 1rem; padding: 10px 20px; margin-top: 20px;}

        /* –°—á–µ—Ç */
        .scoreboard {
            display: flex;
            gap: 40px;
            margin-bottom: 20px;
            font-size: 1.5rem;
            font-weight: bold;
        }
        .score-box {
            padding: 10px 20px;
            border-radius: 10px;
            border: 3px solid transparent;
        }
        .score-box.active-turn {
            background: rgba(255,255,255,0.1);
            border-color: white;
        }
        #s-p1 { color: var(--p1-color); }
        #s-p2 { color: var(--p2-color); }

        /* –ò–≥—Ä–æ–≤–æ–µ –ø–æ–ª–µ */
        #game-board {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 5px;
            background: var(--board-bg);
            padding: 10px;
            border-radius: 10px;
            box-shadow: 0 10px 20px rgba(0,0,0,0.3);
        }

        .cell {
            width: 50px;
            height: 50px;
            background: rgba(0,0,0,0.2);
            border-radius: 5px;
            cursor: pointer;
            position: relative;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        /* –§–∏—à–∫–∞ (–°–ª–∞–π–º) */
        .piece {
            width: 80%;
            height: 80%;
            border-radius: 50%;
            transition: all 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            transform: scale(0);
        }
        .piece.show { transform: scale(1); }
        
        .p1 { background-color: var(--p1-color); box-shadow: inset -3px -3px 0 rgba(0,0,0,0.2); }
        .p2 { background-color: var(--p2-color); box-shadow: inset -3px -3px 0 rgba(0,0,0,0.2); }
        
        /* –í—ã–¥–µ–ª–µ–Ω–∏–µ */
        .selected .piece { border: 3px solid white; }
        
        /* –ü–æ–¥—Å–∫–∞–∑–∫–∏ —Ö–æ–¥–æ–≤ */
        .hint {
            width: 30%;
            height: 30%;
            border-radius: 50%;
        }
        .hint-clone { background-color: var(--text-color); opacity: 0.5; box-shadow: 0 0 10px white; } /* –ë–ª–∏–∂–Ω–∏–π —Ö–æ–¥ */
        .hint-jump { background-color: #ffa502; opacity: 0.8; box-shadow: 0 0 10px #ffa502; } /* –ü—Ä—ã–∂–æ–∫ */

        /* –ê–Ω–∏–º–∞—Ü–∏—è –∑–∞—Ö–≤–∞—Ç–∞ */
        .pop-anim {
            animation: pop 0.4s ease;
        }
        @keyframes pop {
            0% { transform: scale(1); }
            50% { transform: scale(1.4); }
            100% { transform: scale(1); }
        }

        /* –ê–¥–∞–ø—Ç–∏–≤ –¥–ª—è –º–æ–±–∏–ª–æ–∫ */
        @media (max-width: 500px) {
            .cell { width: 40px; height: 40px; }
            button { padding: 10px 20px; font-size: 1rem; }
        }
    </style>
</head>
<body>

    <div id="start-screen" class="screen active">
        <h1>–ë–∏—Ç–≤–∞ –°–ª–∞–π–º–æ–≤ ü¶†</h1>
        <div class="rules-box">
            <h3>–ö–∞–∫ –∏–≥—Ä–∞—Ç—å:</h3>
            <ul>
                <li>üî¥ <strong>–¶–µ–ª—å:</strong> –ó–∞–∫—Ä–∞—Å–∏—Ç—å –ø–æ–ª–µ —Å–≤–æ–∏–º —Ü–≤–µ—Ç–æ–º. –£ –∫–æ–≥–æ –±–æ–ª—å—à–µ —Ñ–∏—à–µ–∫ –≤ –∫–æ–Ω—Ü–µ ‚Äî —Ç–æ—Ç –ø–æ–±–µ–¥–∏–ª.</li>
                <li>üëØ <strong>–•–æ–¥ 1 - –ö–õ–û–ù:</strong> –ö–ª–∏–∫–Ω–∏ –Ω–∞ —Å–æ—Å–µ–¥–Ω—é—é –∫–ª–µ—Ç–∫—É. –¢–≤–æ–π —Å–ª–∞–π–º —Ä–∞–∑–¥–µ–ª–∏—Ç—Å—è. (–°—Ç–∞–Ω–µ—Ç –Ω–∞ 1 –±–æ–ª—å—à–µ).</li>
                <li>üöÄ <strong>–•–æ–¥ 2 - –ü–†–´–ñ–û–ö:</strong> –ö–ª–∏–∫–Ω–∏ —á–µ—Ä–µ–∑ –∫–ª–µ—Ç–∫—É. –°–ª–∞–π–º –ø–µ—Ä–µ–ø—Ä—ã–≥–Ω–µ—Ç —Ç—É–¥–∞. (–°—Ç–∞—Ä–∞—è –∫–ª–µ—Ç–∫–∞ –æ—Å–≤–æ–±–æ–¥–∏—Ç—Å—è).</li>
                <li>üí• <strong>–ê–¢–ê–ö–ê:</strong> –ü—Ä–∏–∑–µ–º–ª–∏–≤—à–∏—Å—å —Ä—è–¥–æ–º —Å –≤—Ä–∞–≥–∞–º–∏, —Ç—ã –ø—Ä–µ–≤—Ä–∞—â–∞–µ—à—å –∏—Ö –≤—Å–µ—Ö –≤ —Å–≤–æ–∏—Ö!</li>
            </ul>
        </div>
        <button onclick="startGame()">–ù–ê–ß–ê–¢–¨ –ò–ì–†–£</button>
    </div>

    <div id="game-screen" class="screen">
        <div class="scoreboard">
            <div id="score-p1" class="score-box">üî¥ <span id="s-p1">2</span></div>
            <div id="score-p2" class="score-box">üü¢ <span id="s-p2">2</span></div>
        </div>
        <h3 id="status-text">–•–æ–¥ –ö—Ä–∞—Å–Ω—ã—Ö</h3>
        
        <div id="game-board">
            </div>

        <button class="restart" onclick="location.reload()">–ó–∞–Ω–æ–≤–æ</button>
    </div>

    <script>
        // --- –ö–û–ù–§–ò–ì–£–†–ê–¶–ò–Ø ---
        const BOARD_SIZE = 7;
        const PLAYER_1 = 1; // –ö—Ä–∞—Å–Ω—ã–π
        const PLAYER_2 = 2; // –ó–µ–ª–µ–Ω—ã–π
        
        // --- –°–û–°–¢–û–Ø–ù–ò–ï –ò–ì–†–´ ---
        let board = []; 
        let currentPlayer = PLAYER_1;
        let selectedCell = null; // {r, c}
        let possibleMoves = []; // [{r, c, type}] (type: 'clone' or 'jump')
        let scores = { 1: 2, 2: 2 };
        let gameActive = false;

        // --- –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø ---
        function startGame() {
            document.getElementById('start-screen').classList.remove('active');
            document.getElementById('game-screen').classList.add('active');
            initBoard();
            renderBoard();
            gameActive = true;
        }

        function initBoard() {
            // –°–æ–∑–¥–∞–µ–º –ø—É—Å—Ç—É—é –º–∞—Ç—Ä–∏—Ü—É 7x7
            for (let r = 0; r < BOARD_SIZE; r++) {
                board[r] = [];
                for (let c = 0; c < BOARD_SIZE; c++) {
                    board[r][c] = 0;
                }
            }
            // –°—Ç–∞—Ä—Ç–æ–≤—ã–µ –ø–æ–∑–∏—Ü–∏–∏ (—É–≥–ª—ã)
            board[0][0] = PLAYER_1;
            board[BOARD_SIZE-1][BOARD_SIZE-1] = PLAYER_1;
            board[0][BOARD_SIZE-1] = PLAYER_2;
            board[BOARD_SIZE-1][0] = PLAYER_2;
            
            updateScore();
        }

        // --- –û–¢–†–ò–°–û–í–ö–ê ---
        function renderBoard() {
            const boardEl = document.getElementById('game-board');
            boardEl.innerHTML = ''; // –û—á–∏—Å—Ç–∫–∞

            for (let r = 0; r < BOARD_SIZE; r++) {
                for (let c = 0; c < BOARD_SIZE; c++) {
                    const cell = document.createElement('div');
                    cell.className = 'cell';
                    cell.onclick = () => handleCellClick(r, c);

                    // –ï—Å–ª–∏ –∫–ª–µ—Ç–∫–∞ –∑–∞–Ω—è—Ç–∞, —Ä–∏—Å—É–µ–º —Ñ–∏—à–∫—É
                    if (board[r][c] !== 0) {
                        const piece = document.createElement('div');
                        piece.className = `piece ${board[r][c] === PLAYER_1 ? 'p1' : 'p2'} show`;
                        cell.appendChild(piece);
                        
                        // –ï—Å–ª–∏ —ç—Ç–∞ —Ñ–∏—à–∫–∞ –≤—ã–±—Ä–∞–Ω–∞
                        if (selectedCell && selectedCell.r === r && selectedCell.c === c) {
                            cell.classList.add('selected');
                        }
                    }

                    // –ï—Å–ª–∏ –∫–ª–µ—Ç–∫–∞ - –≤–æ–∑–º–æ–∂–Ω—ã–π —Ö–æ–¥
                    const move = possibleMoves.find(m => m.r === r && m.c === c);
                    if (move) {
                        const hint = document.createElement('div');
                        hint.className = `hint ${move.type === 'clone' ? 'hint-clone' : 'hint-jump'}`;
                        cell.appendChild(hint);
                    }

                    boardEl.appendChild(cell);
                }
            }
            updateStatus();
        }

        // --- –õ–û–ì–ò–ö–ê ---
        function handleCellClick(r, c) {
            if (!gameActive) return;

            const clickedValue = board[r][c];

            // 1. –ï—Å–ª–∏ –∫–ª–∏–∫–Ω—É–ª–∏ –Ω–∞ –°–í–û–Æ —Ñ–∏—à–∫—É -> –í—ã–±—Ä–∞—Ç—å –µ—ë
            if (clickedValue === currentPlayer) {
                selectedCell = { r, c };
                calculateMoves(r, c);
                renderBoard();
                return;
            }

            // 2. –ï—Å–ª–∏ –∫–ª–∏–∫–Ω—É–ª–∏ –Ω–∞ –ü–û–î–°–í–ï–ß–ï–ù–ù–´–ô —Ö–æ–¥ -> –°—Ö–æ–¥–∏—Ç—å
            const move = possibleMoves.find(m => m.r === r && m.c === c);
            if (move && selectedCell) {
                makeMove(selectedCell, move);
            }
        }

        function calculateMoves(r, c) {
            possibleMoves = [];
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º –∫–ª–µ—Ç–∫–∏ –≤ —Ä–∞–¥–∏—É—Å–µ 2
            for (let dr = -2; dr <= 2; dr++) {
                for (let dc = -2; dc <= 2; dc++) {
                    const nr = r + dr;
                    const nc = c + dc;

                    // –ü—Ä–æ–≤–µ—Ä–∫–∞ –≥—Ä–∞–Ω–∏—Ü –∏ –ø—É—Å—Ç–æ–π –∫–ª–µ—Ç–∫–∏
                    if (nr >= 0 && nr < BOARD_SIZE && nc >= 0 && nc < BOARD_SIZE && board[nr][nc] === 0) {
                        const dist = Math.max(Math.abs(dr), Math.abs(dc));
                        if (dist === 1) possibleMoves.push({ r: nr, c: nc, type: 'clone' });
                        if (dist === 2) possibleMoves.push({ r: nr, c: nc, type: 'jump' });
                    }
                }
            }
        }

        function makeMove(from, to) {
            // 1. –°—Ç–∞–≤–∏–º –Ω–æ–≤—É—é —Ñ–∏—à–∫—É
            board[to.r][to.c] = currentPlayer;

            // 2. –ï—Å–ª–∏ —ç—Ç–æ –ü–†–´–ñ–û–ö, —É–±–∏—Ä–∞–µ–º —Å—Ç–∞—Ä—É—é
            if (to.type === 'jump') {
                board[from.r][from.c] = 0;
            }

            // 3. –ê–°–°–ò–ú–ò–õ–Ø–¶–ò–Ø (–ø—Ä–µ–≤—Ä–∞—â–µ–Ω–∏–µ —Å–æ—Å–µ–¥–µ–π)
            assimilateNeighbors(to.r, to.c);

            // 4. –°–±—Ä–æ—Å –≤—ã–±–æ—Ä–∞
            selectedCell = null;
            possibleMoves = [];

            // 5. –ü–µ—Ä–µ–¥–∞—á–∞ —Ö–æ–¥–∞
            currentPlayer = currentPlayer === PLAYER_1 ? PLAYER_2 : PLAYER_1;
            
            // 6. –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–Ω—Ü–∞ –∏–≥—Ä—ã
            updateScore();
            renderBoard();
            checkWinCondition();
        }

        function assimilateNeighbors(r, c) {
            for (let dr = -1; dr <= 1; dr++) {
                for (let dc = -1; dc <= 1; dc++) {
                    const nr = r + dr;
                    const nc = c + dc;
                    // –ï—Å–ª–∏ —Å–æ—Å–µ–¥ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –∏ –æ–Ω –í–†–ê–ì
                    if (nr >= 0 && nr < BOARD_SIZE && nc >= 0 && nc < BOARD_SIZE) {
                        if (board[nr][nc] !== 0 && board[nr][nc] !== currentPlayer) {
                            board[nr][nc] = currentPlayer; // –ú–µ–Ω—è–µ–º —Ü–≤–µ—Ç!
                        }
                    }
                }
            }
        }

        function updateScore() {
            let p1 = 0;
            let p2 = 0;
            let empty = 0;

            for (let r = 0; r < BOARD_SIZE; r++) {
                for (let c = 0; c < BOARD_SIZE; c++) {
                    if (board[r][c] === PLAYER_1) p1++;
                    else if (board[r][c] === PLAYER_2) p2++;
                    else empty++;
                }
            }
            scores = { 1: p1, 2: p2 };
            document.getElementById('s-p1').innerText = p1;
            document.getElementById('s-p2').innerText = p2;
            
            return empty; // –≤–æ–∑–≤—Ä–∞—â–∞–µ–º –∫–æ–ª-–≤–æ –ø—É—Å—Ç—ã—Ö –∫–ª–µ—Ç–æ–∫
        }

        function updateStatus() {
            const statusEl = document.getElementById('status-text');
            const scoreP1 = document.getElementById('score-p1');
            const scoreP2 = document.getElementById('score-p2');

            if (!gameActive) return;

            if (currentPlayer === PLAYER_1) {
                statusEl.innerText = "–•–æ–¥ –ö—Ä–∞—Å–Ω—ã—Ö üî¥";
                statusEl.style.color = "var(--p1-color)";
                scoreP1.classList.add('active-turn');
                scoreP2.classList.remove('active-turn');
            } else {
                statusEl.innerText = "–•–æ–¥ –ó–µ–ª–µ–Ω—ã—Ö üü¢";
                statusEl.style.color = "var(--p2-color)";
                scoreP2.classList.add('active-turn');
                scoreP1.classList.remove('active-turn');
            }
        }

        function checkWinCondition() {
            const emptyCount = updateScore();
            const p1Count = scores[1];
            const p2Count = scores[2];
            let winner = null;

            // –ï—Å–ª–∏ –ø–æ–ª–µ –ø–æ–ª–Ω–æ–µ –∏–ª–∏ —É –∫–æ–≥–æ-—Ç–æ 0 —Ñ–∏—à–µ–∫
            if (emptyCount === 0 || p1Count === 0 || p2Count === 0) {
                if (p1Count > p2Count) winner = "–ö—Ä–∞—Å–Ω—ã–µ –ø–æ–±–µ–¥–∏–ª–∏!";
                else if (p2Count > p1Count) winner = "–ó–µ–ª–µ–Ω—ã–µ –ø–æ–±–µ–¥–∏–ª–∏!";
                else winner = "–ù–∏—á—å—è!";
                
                endGame(winner);
                return;
            }
            
            // –ü—Ä–æ–≤–µ—Ä–∫–∞: –∞ –º–æ–∂–µ—Ç –ª–∏ —Ç–µ–∫—É—â–∏–π –∏–≥—Ä–æ–∫ –≤–æ–æ–±—â–µ —Å–¥–µ–ª–∞—Ç—å —Ö–æ–¥?
            // (–ü—Ä–æ—Å—Ç–æ–π –≤–∞—Ä–∏–∞–Ω—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏: –µ—Å–ª–∏ —É –∏–≥—Ä–æ–∫–∞ –µ—Å—Ç—å —Ñ–∏—à–∫–∏, –Ω–æ –Ω–µ–∫—É–¥–∞ —Ö–æ–¥–∏—Ç—å - –æ–Ω –ø—Ä–æ–ø—É—Å–∫–∞–µ—Ç —Ö–æ–¥, 
            // –Ω–æ –¥–ª—è –ø—Ä–æ—Å—Ç–æ—Ç—ã –º—ã –∑–∞–∫–æ–Ω—á–∏–º –∏–≥—Ä—É, –µ—Å–ª–∏ –ø–æ–ª–Ω–∞—è –±–ª–æ–∫–∞–¥–∞)
            if (!canPlayerMove(currentPlayer)) {
                 // –ü–µ—Ä–µ–¥–∞–µ–º —Ö–æ–¥ –æ–±—Ä–∞—Ç–Ω–æ
                 currentPlayer = currentPlayer === PLAYER_1 ? PLAYER_2 : PLAYER_1;
                 // –ï—Å–ª–∏ –∏ –≤—Ç–æ—Ä–æ–π –Ω–µ –º–æ–∂–µ—Ç - –∫–æ–Ω–µ—Ü
                 if (!canPlayerMove(currentPlayer)) {
                     endGame("–ù–∏ —É –∫–æ–≥–æ –Ω–µ—Ç —Ö–æ–¥–æ–≤!");
                 } else {
                     alert("–ù–µ—Ç —Ö–æ–¥–æ–≤! –•–æ–¥ –ø–µ—Ä–µ—Ö–æ–¥–∏—Ç —Å–æ–ø–µ—Ä–Ω–∏–∫—É.");
                     renderBoard();
                 }
            }
        }

        function canPlayerMove(player) {
            for (let r = 0; r < BOARD_SIZE; r++) {
                for (let c = 0; c < BOARD_SIZE; c++) {
                    if (board[r][c] === player) {
                        // –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å–æ—Å–µ–¥–µ–π
                         for (let dr = -2; dr <= 2; dr++) {
                            for (let dc = -2; dc <= 2; dc++) {
                                const nr = r + dr;
                                const nc = c + dc;
                                if (nr >= 0 && nr < BOARD_SIZE && nc >= 0 && nc < BOARD_SIZE && board[nr][nc] === 0) {
                                    return true; // –ï—Å—Ç—å —Ö–æ—Ç—è –±—ã –æ–¥–∏–Ω —Ö–æ–¥
                                }
                            }
                        }
                    }
                }
            }
            return false;
        }

        function endGame(msg) {
            gameActive = false;
            document.getElementById('status-text').innerText = msg;
            document.getElementById('status-text').style.color = "white";
            alert(msg + "\n–°—á–µ—Ç: " + scores[1] + " : " + scores[2]);
        }
    </script>
</body>
</html>
